<!doctype html>
<html>
<head>
<title>Using Event Binder</title>
<script>
YUI_config = {
	eventbinder: {
	  // set of options that should be preserved for every event (they are all optional)
	  e: {ctrlKey:0, altKey:0, shiftKey:0, metaKey:0, keyCode:0, charCode:0, screenX:0, screenY:0, clientX:0, clientY:0, button:0, relatedTarget:0},
		// listener callback function
		fn: function (e) {
			var o = YUI_config.eventbinder,
			    classCheck = /yui3-event-binder/, i, 
			    t = (e.target?e.target:e.srcElement),
			    p = {target:t, type: e.type},
				  container = t;

			// looking for an element with the class yui3-event-binder
			while (container && !classCheck.test(container.className)) {
				container = container.parentNode;
			}

			if (container) {
				t.className+=' yui3-waiting';

				// backing up the event properties to simulate the event later on
				for (i in (o.e||{})) {
				  if (o.e.hasOwnProperty(i)) {
				    p[i] = e[i];
			    }
				}
				(o.q = o.q || []).push(p);

				// preventing the default browser action for this event
				e.preventDefault?e.preventDefault():e;
				return (e.returnValue = false);
			}
		},
		add: function (type) {
			d = document;
			if (d.addEventListener) {
				d.addEventListener(type, this.fn, false);
			}
			else {
				d.attachEvent('on'+type, this.fn);
			}
			return this;
		}
	}
};
YUI_config.eventbinder.add('click');
</script>
</head>
<body class="yui3-skin-sam">
	
    <div id="doc">
    	
		<h1>Using Gallery Event Binder</h1>
		
		<div id="demo" class="yui3-event-binder">
			<p>Placeholder for <a href="http://yuilibrary.com/">click</a> listener</p>
		</div>
		
		<h3>Output:</h3>
		<ul id="output"></ul>
		
    </div>

<!-- YUI 3 Seed //-->
<script type="text/javascript" src="http://yui.yahooapis.com/3.1.1/build/yui/yui-debug.js"></script>
<!-- Initialization process //-->
<script type="text/javascript" src="../js-demo/event-binder.js"></script>
<script type="text/javascript">
YUI({
	filter: 'debug', combine: false
}).use('gallery-event-binder', 'event', 'node', function(Y) {

	var ul = Y.one ('#output');
	ul.append('<li>waiting 3000ms to flush the events</li>');
	
	Y.later (3000, {}, function() {

		Y.on('click', function(e) {
			ul.append('<li>clicked - Targer: '+ e.target.get('tagName')+'</li>');
			e.halt();
		}, '#demo');

		ul.append('<li>flushing</li>');
		Y.EventBinder.flush('click');
		ul.append('<li>finish</li>');

	});
 
});
</script>
</body>
</html>